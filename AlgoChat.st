Object subclass: #AlgoChat	instanceVariableNames: 'listaDeUsuarios listaDeCanales usuarios canales conversaciones'	classVariableNames: ''	package: 'AlgoChat'!!AlgoChat methodsFor: 'initialization' stamp: 'CristianTorales 9/15/2019 11:22'!initializeusuarios := Dictionary  new. canales := Dictionary  new. conversaciones := Dictionary  new. ! !!AlgoChat methodsFor: 'acccessing' stamp: 'CristianTorales 9/14/2019 19:18'!getCantidadUsuarios^usuarios size.! !!AlgoChat methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/19/2019 01:29'!agregarPalabraClave: unaPalabraClave alUsuario: unNombreDeUsuario| unUsuario canalesDelUsuario |unUsuario := self getUsuario: unNombreDeUsuario.unUsuario agregarPalabraClave: unaPalabraClave.canalesDelUsuario := unUsuario getCanalesDelUsuario.canalesDelUsuario do: [:unCanal | unCanal agregarUsuarioNotificablePorPalabraClave: (unUsuario obtenerNombre)  ].! !!AlgoChat methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/14/2019 22:03'!getCanal: unNombreDeCanal ^canales at: unNombreDeCanal.! !!AlgoChat methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/15/2019 18:30'!getMensajesDeConversacion: unNombreDeConversacion | unaConversacion |unaConversacion :=  self getConversacion: unNombreDeConversacion.^unaConversacion  getMensajesDeLaConversacion.! !!AlgoChat methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/15/2019 18:11'!publicarMensaje: unMensaje  enConversacion: unGrupoDeUsuarios| unaConversacion |unaConversacion  := self getConversacion: unGrupoDeUsuarios.unaConversacion recibirPublicacion: unMensaje.! !!AlgoChat methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/18/2019 17:05'!agregarUsuario: unUsuario alCanal: unCanal | canalActual usuarioParaAgregar |canalActual := self getCanal: unCanal.usuarioParaAgregar :=  self getUsuario: unUsuario.canalActual  agregarUsuarioAlCanal: usuarioParaAgregar.! !!AlgoChat methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/17/2019 15:57'!crearConversacionConUsuarios: nombresDeUsuarios|nuevaConversacion nombres |nuevaConversacion := Conversacion  new.nombres := nombresDeUsuarios  splitOn: ','.nombres do: [ :unNombreUsuario |  	           nuevaConversacion agregarUnUsuario: (self getUsuario: unNombreUsuario) ].conversaciones at: nombresDeUsuarios  put: nuevaConversacion.! !!AlgoChat methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/19/2019 02:51'!reanudarPalabrasDeCanal: unCanal paraUsuario: unNombreDeUsuario| canal usuariosPausados |canal := self getCanal: unCanal.usuariosPausados := canal getUsuariosPausadosPorPalabraClave.usuariosPausados removeKey: unNombreDeUsuario. ! !!AlgoChat methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/15/2019 17:40'!getConversacion: nombreDeLaConversacion^conversaciones at: nombreDeLaConversacion. ! !!AlgoChat methodsFor: 'canales' stamp: 'CristianTorales 9/14/2019 20:47'!getCantidadCanales^canales size.! !!AlgoChat methodsFor: 'canales' stamp: 'CristianTorales 9/19/2019 02:43'!pausarPalabrasDeCanal: nombreDeCanal paraUsuario: unNombreDeUsuario| canal  unUsuarioDelCanal |canal := canales at: nombreDeCanal.unUsuarioDelCanal := usuarios at: unNombreDeUsuario.canal agregarUsuarioPausadoPorPalabraClave: unUsuarioDelCanal.! !!AlgoChat methodsFor: 'canales' stamp: 'CristianTorales 9/14/2019 22:43'!mensajesDelCanal: unNombreDeCanal  resumidosALongitud: unaLongitudParaMensajes| unCanal |unCanal := self getCanal: unNombreDeCanal.^unCanal getMensajesResumidosALongitud: unaLongitudParaMensajes.! !!AlgoChat methodsFor: 'canales' stamp: 'CristianTorales 9/19/2019 01:19'!publicarMensaje: unMensaje enCanal: unNombreDeCanal| unCanal |unCanal := self getCanal: unNombreDeCanal."usuariosDeEsteCanal := unCanal getUsuariosDelCanal.unMensaje includes: '@'.unMensaje includes: (usuariosDeEsteCanal at: 'juan')."unCanal agregarMensaje: unMensaje."unCanal agregarNotificacionesAUsuarios: unMensaje."! !!AlgoChat methodsFor: 'canales' stamp: 'CristianTorales 9/14/2019 22:12'!mensajesDelCanal: unNombreDeCanal| unCanal |unCanal := self getCanal: unNombreDeCanal.^unCanal getMensajes.! !!AlgoChat methodsFor: 'canales' stamp: 'CristianTorales 9/14/2019 21:13'!agregarCanalConNombre: unNombreDeCanal| nuevoCanal |nuevoCanal := Canal new. nuevoCanal definirNombreDeCanal: unNombreDeCanal.canales  at: unNombreDeCanal put: nuevoCanal.! !!AlgoChat methodsFor: 'usuarios' stamp: 'CristianTorales 9/17/2019 15:52'!enviarMensaje: unMensaje aUsuario: unNombreDeUsuario | usuarioActual |usuarioActual := self getUsuario: unNombreDeUsuario.usuarioActual recibirMensaje: unMensaje.! !!AlgoChat methodsFor: 'usuarios' stamp: 'CristianTorales 9/15/2019 16:28'!getUsuario: unNombreDeUsuario ^usuarios at: unNombreDeUsuario.! !!AlgoChat methodsFor: 'usuarios' stamp: 'CristianTorales 9/14/2019 19:24'!getNotificacionesDeUsuario: unNombreDeUsuario | unUsuario |unUsuario := self getUsuario: unNombreDeUsuario.^unUsuario getNotificaciones.! !!AlgoChat methodsFor: 'usuarios' stamp: 'CristianTorales 9/17/2019 15:53'!agregarUsuarioConNombre: unNombreDeUsuario| nuevoUsuario  |nuevoUsuario := Usuario new. nuevoUsuario definirNombre: unNombreDeUsuario.usuarios at: unNombreDeUsuario put: nuevoUsuario.! !!AlgoChat methodsFor: 'usuarios' stamp: 'CristianTorales 9/6/2019 20:05'!getNotificacionesDeUsuario: unNombreDeUsuario  resumidasALongitud: unaLongitud^'hola... | como...'.! !Object subclass: #Canal	instanceVariableNames: 'nombre nombreDeCanal mensajesDelCanal usuariosDelCanal notificacionesDelCanal usuariosNotificablesPorClave usuariosPausadosPorPalabraClave usuariosMencionados notificadorDelCanal'	classVariableNames: ''	package: 'AlgoChat'!!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/19/2019 02:28'!agregarNotificacionesAUsuariosDelCanalPorMedioDePalabraClave: unMensaje"usuariosNotificablesPorClave  valuesDo: [ :unUsuario | 	unUsuario recibirMensajeSegunLaClaveDelMensaje: unMensaje   ].  "| usuariosNotificables |usuariosNotificables := usuariosDelCanal buscarDiferenciasConOtroConjunto: usuariosPausadosPorPalabraClave.notificadorDelCanal notificarConPalabraClaveAlConjuntoDeUsuarios: usuariosNotificables conMensaje: unMensaje.! !!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/18/2019 22:42'!agregarUsuarioNotificablePorPalabraClave: unNombreDeUsuario | usuario |usuario := usuariosDelCanal getUnUsuario:  unNombreDeUsuario.usuariosNotificablesPorClave agregarUsuario: usuario.! !!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/18/2019 12:26'!getUsuarioDelCanalConNombre: unNomnbreDeUsuario^usuariosDelCanal getUnUsuario: unNomnbreDeUsuario.! !!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/19/2019 02:48'!getUsuariosPausadosPorPalabraClave^usuariosPausadosPorPalabraClave.! !!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/14/2019 21:35'!getNombreDelCanal^nombreDeCanal.! !!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/17/2019 00:11'!agregarMensaje: unMensajeParaElCanalself agregarNotificacionesAUsuarios: unMensajeParaElCanal.mensajesDelCanal add: unMensajeParaElCanal.! !!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/19/2019 02:34'!agregarNotificacionesAUsuariosDelCanal: unMensajenotificadorDelCanal notificarMensaje: unMensaje  aColeccionDeUsuarios: usuariosMencionados. ! !!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/15/2019 00:18'!getMensajesResumidosALongitud: unaLongitud | todosLosMensajes |todosLosMensajes := ''.mensajesDelCanal  do: [ :mensaje | 	todosLosMensajes:= todosLosMensajes ,	 (mensaje truncateTo: unaLongitud),	 '...'  ]separatedBy: [ todosLosMensajes := todosLosMensajes, ' | ' ].^todosLosMensajes."^'tp0... | fec... | se ...'. "! !!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/17/2019 16:45'!getMensajes^mensajesDelCanal joinUsing: ' | '.! !!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/14/2019 21:15'!definirNombreDeCanal: unNombreDeCanal nombreDeCanal := unNombreDeCanal. ! !!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/18/2019 22:52'!getUsuariosDelCanal^usuariosDelCanal getUsuariosDelConjunto.! !!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/16/2019 19:23'!borrarUnUsuarioNotificablePorClave: unNombreDeUsuariousuariosNotificablesPorClave removeKey:  unNombreDeUsuario.! !!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/18/2019 22:39'!getUsuarioNotificableConNombre: unNombreDeUsuario^usuariosNotificablesPorClave getUnUsuario: unNombreDeUsuario.! !!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/18/2019 23:43'!agregarUsuarioAlCanal: unUsuario usuariosDelCanal agregarUsuario: unUsuario.! !!Canal methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/19/2019 02:19'!agregarNotificacionesAUsuarios: unMensaje usuariosMencionados := usuariosDelCanal buscarUsuariosMencionadosEn: unMensaje.notificadorDelCanal agregarMensaje: unMensaje  conUsuariosMencionados: usuariosMencionados.self agregarNotificacionesAUsuariosDelCanal: unMensaje.self agregarNotificacionesAUsuariosDelCanalPorMedioDePalabraClave: unMensaje. ! !!Canal methodsFor: 'initialization' stamp: 'CristianTorales 9/19/2019 02:29'!initializenombreDeCanal := ''.notificadorDelCanal := Notificador new.mensajesDelCanal := OrderedCollection new.notificacionesDelCanal := OrderedCollection new.usuariosDelCanal := ConjuntoDeUsuarios new.usuariosMencionados :=  Dictionary new.usuariosPausadosPorPalabraClave := Dictionary   new.usuariosNotificablesPorClave := ConjuntoDeUsuarios new.! !!Canal methodsFor: 'usuarios' stamp: 'CristianTorales 9/18/2019 12:19'!agregarUsuarioConNombre: unNombreDeUsuariousuariosDelCanal agregarUsuarioConNombre: unNombreDeUsuario.! !!Canal methodsFor: 'pausarUsuarios' stamp: 'CristianTorales 9/18/2019 22:54'!agregarUsuarioPausadoPorPalabraClave: unUsuariousuariosPausadosPorPalabraClave at: unUsuario obtenerNombre  put: unUsuario.! !!Canal methodsFor: 'pausarUsuarios' stamp: 'CristianTorales 9/18/2019 22:53'!getUsuarioPausadoPorPalabraClave: unNombreDeUsuario^usuariosPausadosPorPalabraClave at:  unNombreDeUsuario.! !Object subclass: #ConjuntoDeUsuarios	instanceVariableNames: 'usuariosDelConjunto usuariosNotificablesPorPalabraClave'	classVariableNames: ''	package: 'AlgoChat'!!ConjuntoDeUsuarios methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/17/2019 17:47'!getPalabraClaveDeUsuarioConNombre: unNombreDeUsuario^(usuariosDelConjunto at: unNombreDeUsuario) getPalabraClave.! !!ConjuntoDeUsuarios methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/18/2019 17:56'!buscarDiferenciasConOtroConjunto: unSubconjunto^usuariosDelConjunto difference: unSubconjunto.! !!ConjuntoDeUsuarios methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/19/2019 02:31'!buscarUsuariosMencionadosEn: unMensaje| usuariosMencionados |usuariosMencionados := Dictionary  new.usuariosDelConjunto valuesDo: [ :unUsuario | 	((unMensaje findString: (unUsuario getLlamadoAUsuario))>0) ifTrue: [ usuariosMencionados at: unUsuario obtenerNombre  put: unUsuario ]  ].^usuariosMencionados.! !!ConjuntoDeUsuarios methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/18/2019 20:27'!getUsuariosDelConjunto^usuariosDelConjunto.! !!ConjuntoDeUsuarios methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/19/2019 01:02'!agregarUsuario: unUsuariousuariosDelConjunto  at: (unUsuario obtenerNombre) put: unUsuario.! !!ConjuntoDeUsuarios methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/17/2019 00:52'!getUnUsuario: unNombreDeUsuario^usuariosDelConjunto at: unNombreDeUsuario.! !!ConjuntoDeUsuarios methodsFor: 'initialization' stamp: 'CristianTorales 9/17/2019 08:33'!initializeusuariosDelConjunto := Dictionary new.usuariosNotificablesPorPalabraClave := Dictionary new.! !!ConjuntoDeUsuarios methodsFor: 'usuarios' stamp: 'CristianTorales 9/19/2019 01:04'!agregarUsuarioConNombre: unNombreDeUsuario| nuevoUsuario |nuevoUsuario := Usuario new.nuevoUsuario definirNombre: unNombreDeUsuario.usuariosDelConjunto at: (nuevoUsuario obtenerNombre) put: nuevoUsuario.! !Object subclass: #Conversacion	instanceVariableNames: 'usuariosDeLaConversación mensajesDeLaConversacion'	classVariableNames: ''	package: 'AlgoChat'!!Conversacion methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/15/2019 18:03'!getUsuariosDeLaConversacion"| listaDeUsuarios |listaDeUsuarios := usuariosDeLaConversación select: [ :cadaUsuario | cadaUsuario obtenerNombre  ]."^usuariosDeLaConversación joinUsing: ','."'juan,pablo'.  "! !!Conversacion methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/15/2019 16:06'!getCantidadDeUsuarios^usuariosDeLaConversación size.! !!Conversacion methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/15/2019 18:20'!recibirPublicacion: unMensaje mensajesDeLaConversacion add: unMensaje.self agregarNotificacionALosUsuarios: unMensaje. ! !!Conversacion methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/15/2019 16:09'!agregarUsuarios: conjuntoDeUsuarios! !!Conversacion methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/17/2019 16:46'!getMensajesDeLaConversacion^mensajesDeLaConversacion joinUsing: ' | '.! !!Conversacion methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/15/2019 17:02'!agregarUnUsuario: unUsuariousuariosDeLaConversación at: unUsuario obtenerNombre  put: unUsuario.! !!Conversacion methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/15/2019 18:24'!agregarNotificacionALosUsuarios: unMensaje usuariosDeLaConversación do: [ :cadaUsuario |	cadaUsuario agregarMensaje: unMensaje ].! !!Conversacion methodsFor: 'initialization' stamp: 'CristianTorales 9/15/2019 18:13'!initialize usuariosDeLaConversación := Dictionary new.mensajesDeLaConversacion := OrderedCollection new.! !Object subclass: #Notificador	instanceVariableNames: 'palabrasClave mensaje usuariosMencionadosEnElMensaje'	classVariableNames: ''	package: 'AlgoChat'!!Notificador methodsFor: 'initialization' stamp: 'CristianTorales 9/19/2019 02:13'!initialize mensaje := ''.usuariosMencionadosEnElMensaje := Dictionary new.! !!Notificador methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/18/2019 21:43'!notificarMensaje: unMensaje aColeccionDeUsuarios: unConjuntoDeUsuariosunConjuntoDeUsuarios  valuesDo:  [ :unUsuario | unUsuario recibirMensaje: unMensaje   ].! !!Notificador methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/19/2019 01:48'!notificarAlUsuario: unUsuario siTienePalabraClaveEn: unMensaje| palabras |palabras := unUsuario getConjuntoDePalabrasClave.((unUsuario getNotificaciones)  includes: unMensaje) ifFalse: [   palabras keysDo: [ :unaPalabraClave | ((unMensaje findString: unaPalabraClave)>0) ifTrue:  	[ unUsuario  recibirMensaje:   unMensaje  ] ].].! !!Notificador methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/19/2019 02:16'!agregarMensaje: unMensaje conUsuariosMencionados: unConjuntoDeUsuariosmensaje := unMensaje.usuariosMencionadosEnElMensaje := unConjuntoDeUsuarios.! !!Notificador methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/18/2019 20:31'!notificarMensaje: unMensaje a: unConjuntoDeUsuarios| usuarios |usuarios := unConjuntoDeUsuarios getUsuariosDelConjunto.usuarios valuesDo:  [ :unUsuario | unUsuario recibirMensaje: unMensaje   ].! !!Notificador methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/19/2019 02:24'!notificarConPalabraClaveAlConjuntoDeUsuarios: unConjuntoDeUsuarios conMensaje: unMensajeunConjuntoDeUsuarios valuesDo: [ :unUsuarioDelConjunto | 	                             (usuariosMencionadosEnElMensaje includes: unUsuarioDelConjunto) ifFalse: [   self notificarAlUsuario: unUsuarioDelConjunto siTienePalabraClaveEn: unMensaje ]  ].! !Object subclass: #Usuario	instanceVariableNames: 'nombre mensajesDelUsuario notificacionesDeUsuario palabraClave canalesDelUsuario'	classVariableNames: ''	package: 'AlgoChat'!!Usuario methodsFor: 'initialization' stamp: 'CristianTorales 9/16/2019 19:54'!initialize nombre := ''.palabraClave := Dictionary new.notificacionesDeUsuario := OrderedCollection new.mensajesDelUsuario := OrderedCollection new.canalesDelUsuario := Dictionary new.! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/14/2019 19:14'!recibirMensaje: unMensaje mensajesDelUsuario add: unMensaje.! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/6/2019 21:36'!obtenerNombre^nombre.! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/16/2019 02:13'!getPalabraClave: unaPalabraClave ^palabraClave at: unaPalabraClave .! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/8/2019 12:05'!agregarMensaje: unMensajemensajesDelUsuario add: unMensaje.! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/17/2019 17:18'!getConjuntoDePalabrasClave^palabraClave.! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/19/2019 01:23'!getCanalesDelUsuario^canalesDelUsuario.! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/16/2019 20:12'!agregarUsuarioNotificableALosCanalescanalesDelUsuario do:  [ :unCanal | unCanal agregarUsuarioNotificablePorPalabraClave: nombre  ].! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/15/2019 20:56'!getLlamadoAUsuario^'@',nombre.! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/16/2019 03:14'!recibirMensajeSegunLaClaveDelMensaje: unMensaje (mensajesDelUsuario includes: unMensaje) ifFalse: [  palabraClave keysDo: [ :unaPalabraClave | ((unMensaje findString: unaPalabraClave)>0) ifTrue:  	[ self recibirMensaje:   unMensaje  ] ].].! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/14/2019 20:30'!getMensajes^mensajesDelUsuario at: 1.! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/18/2019 23:22'!getNotificaciones"^mensajesDelUsuario at: 1. ""| res |res := ''.mensajesDelUsuario do: [ :e | res := res, e asString ] separatedBy: [ res := res, ' | ' ].^res."^mensajesDelUsuario  joinUsing: ' | '.! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/16/2019 02:45'!agregarPalabraClave: unaPalabraClave palabraClave at: unaPalabraClave put: unaPalabraClave.! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/6/2019 21:34'!definirNombre: unNombreDeUsuarionombre := unNombreDeUsuario.! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/9/2019 17:03'!getCantidadDeMensajes^mensajesDelUsuario size.! !!Usuario methodsFor: 'as yet unclassified' stamp: 'CristianTorales 9/16/2019 20:02'!agregarCanal: unCanalcanalesDelUsuario at: unCanal.! !